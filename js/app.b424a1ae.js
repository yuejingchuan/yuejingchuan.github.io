(function(){"use strict";var e={1009:function(e,t,l){var a=l(6369),o=function(){var e=this,t=e._self._c;return t("div",[t("router-view")],1)},s=[],r={},i=r,n=l(1001),m=(0,n.Z)(i,o,s,!1,null,null,null),c=m.exports,u=l(8499),f=l.n(u),h=l(2631),p=function(){var e=this,t=e._self._c;return t("div",[t("div",{staticClass:"left"},[t("el-form",{ref:"form",attrs:{model:e.form,"label-width":"auto"}},[t("el-form-item",{attrs:{label:"接入号"}},[t("el-input",{model:{value:e.form.num,callback:function(t){e.$set(e.form,"num",t)},expression:"form.num"}})],1),t("el-form-item",{attrs:{label:"用户名称"}},[t("el-input",{model:{value:e.form.username,callback:function(t){e.$set(e.form,"username",t)},expression:"form.username"}})],1),t("el-form-item",{attrs:{label:"新装地址"}},[t("el-input",{model:{value:e.form.siteNew,callback:function(t){e.$set(e.form,"siteNew",t)},expression:"form.siteNew"}})],1),t("el-form-item",{attrs:{label:"带宽速率"}},[t("el-input",{model:{value:e.form.netSpeed,callback:function(t){e.$set(e.form,"netSpeed",t)},expression:"form.netSpeed"}})],1),t("el-form-item",{attrs:{label:"用户联系人"}},[t("el-input",{model:{value:e.form.contactPerson,callback:function(t){e.$set(e.form,"contactPerson",t)},expression:"form.contactPerson"}})],1),t("el-form-item",{attrs:{label:"客户经理"}},[t("el-input",{model:{value:e.form.manager,callback:function(t){e.$set(e.form,"manager",t)},expression:"form.manager"}})],1),t("el-form-item",{attrs:{label:"光路名称"}},[t("el-input",{model:{value:e.form.cableName,callback:function(t){e.$set(e.form,"cableName",t)},expression:"form.cableName"}})],1),t("el-form-item",{attrs:{label:"光路路由"}},[t("el-input",{model:{value:e.form.cablePath,callback:function(t){e.$set(e.form,"cablePath",t)},expression:"form.cablePath"}})],1),t("el-form-item",{attrs:{label:"光缆段编码"}},[t("el-input",{model:{value:e.form.cableCode,callback:function(t){e.$set(e.form,"cableCode",t)},expression:"form.cableCode"}})],1),t("el-form-item",{attrs:{label:"对应分局"}},[t("el-input",{model:{value:e.form.regions,callback:function(t){e.$set(e.form,"regions",t)},expression:"form.regions"}})],1),t("el-form-item",{attrs:{label:"调单号"}},[t("el-input",{model:{value:e.labelNum,callback:function(t){e.labelNum=t},expression:"labelNum"}})],1),t("el-form-item",[t("el-button",{attrs:{type:"success",round:""},on:{click:e.generateNum}},[e._v("生成调单号")])],1),t("el-form-item",{attrs:{label:"是否直连MSE"}},[t("el-switch",{model:{value:e.delivery,callback:function(t){e.delivery=t},expression:"delivery"}})],1),t("el-form-item",{attrs:{label:"调单联系人"}},[t("el-select",{attrs:{placeholder:"请选择"},model:{value:e.dispatchName,callback:function(t){e.dispatchName=t},expression:"dispatchName"}},e._l(e.options,(function(e){return t("el-option",{key:e.value,attrs:{label:e.label,value:e.label}})})),1)],1),t("el-form-item",[t("el-button",{attrs:{type:"primary"},on:{click:e.downFile}},[e._v("导出")]),t("el-button",{on:{click:e.reset}},[e._v("重置")])],1)],1)],1),t("div",{staticClass:"right"},[e.delivery?e.delivery?t("div",[t("el-form",{attrs:{model:e.form2,"label-width":"auto"}},[t("el-form-item",{attrs:{label:"数据端口"}},[t("el-input",{model:{value:e.form2.dataPort,callback:function(t){e.$set(e.form2,"dataPort",t)},expression:"form2.dataPort"}})],1)],1)],1):e._e():t("div",[t("el-form",{ref:"form",attrs:{model:e.form2,"label-width":"auto"}},[t("el-form-item",{attrs:{label:"数据端口"}},[t("el-input",{model:{value:e.form2.dataPort,callback:function(t){e.$set(e.form2,"dataPort",t)},expression:"form2.dataPort"}})],1),t("el-form-item",{attrs:{label:"ONU端口"}},[t("el-input",{model:{value:e.onuPort,callback:function(t){e.onuPort=t},expression:"onuPort"}})],1),t("el-form-item",{attrs:{label:"ONUID"}},[t("el-input",{model:{value:e.form2.onuId,callback:function(t){e.$set(e.form2,"onuId",t)},expression:"form2.onuId"}})],1),t("el-form-item",{attrs:{label:"Vlan"}},[t("el-input",{model:{value:e.form2.vlanNum,callback:function(t){e.$set(e.form2,"vlanNum",t)},expression:"form2.vlanNum"}})],1),t("el-form-item",{attrs:{label:"OLT端口"}},[t("el-input",{model:{value:e.form2.oltPort,callback:function(t){e.$set(e.form2,"oltPort",t)},expression:"form2.oltPort"}})],1)],1)],1)])])},d=[],b={created(){this.$axios.post("http://localhost:8888/users",{username:this.$storeNew.get("username"),password:this.$storeNew.get("password")}).then((e=>{this.dispatchNum=e.data[0][3]})).catch((e=>console.log(e)))},data(){return{form:{num:"",username:"",siteNew:"",netSpeed:"",contactPerson:"",manager:"",cableName:"",cablePath:"",cableCode:"",regions:""},dispatchNum:"",delivery:!1,form2:{dataPort:"",onuId:"",vlanNum:"",oltPort:""},options:[{value:1,label:"岳靖川19980798836"},{value:2,label:"徐桂英199XXXXXX"}],dispatchName:""}},computed:{onuPort(){return this.form2.dataPort+"-1"},labelNum(){const e=new Date;return"ZYBD"+e.getFullYear()+"-"+(e.getMonth()+1)+"-"+this.dispatchNum}},methods:{reset(){for(let e in this.form)this.form[e]="";for(let e in this.form2)this.form2[e]="";this.delivery=!1},generateNum(){this.dispatchNum++,this.$axios.post("http://localhost:8888/update",{dispatchNum:this.dispatchNum,username:this.$storeNew.get("username")}).then((e=>console.log(e.data))).catch((e=>console.log(e)))},downFile(){this.delivery?this.$excel({filename:this.labelNum,sheet:[{sheetName:this.labelNum,keys:["sheet1","sheet2"],table:[{sheet1:"传统商务光纤 新开,请按调单进行线路调通",sheet2:""},{sheet1:"调度依据",sheet2:this.form.num},{sheet1:"新装地址",sheet2:this.form.siteNew},{sheet1:"光路信息",sheet2:""},{sheet1:"光路名称",sheet2:this.form.cableName},{sheet1:"光路路由",sheet2:this.form.cablePath},{sheet1:"光路路由",sheet2:this.form.cableCode},{sheet1:"相关设备及数据信息",sheet2:""},{sheet1:"数据端口",sheet2:this.form2.dataPort},{sheet1:"速率",sheet2:this.form.netSpeed},{sheet1:"其他信息",sheet2:""},{sheet1:"调测分局",sheet2:this.form.regions},{sheet1:"用户联系人",sheet2:this.form.contactPerson},{sheet1:"客户经理",sheet2:this.form.manager},{sheet1:"调单联系人",sheet2:this.dispatchName}],merges:["1-1:2-1","1-4:2-4","1-8:2-8","1-11:2-11"],colWidth:[50,150],globalStyle:{font:{name:"黑体"},alignment:{wrapText:!0}},cellStyle:[{cell:"1-1",fill:{fgColor:{rgb:"ffff33"}},font:{sz:14,bold:!0}},{cell:"1-4",fill:{fgColor:{rgb:"ffff33"}},font:{sz:14,bold:!0}},{cell:"1-8",fill:{fgColor:{rgb:"ffff33"}},font:{sz:14,bold:!0}},{cell:"1-11",fill:{fgColor:{rgb:"ffff33"}},font:{sz:14,bold:!0}}]}]}):this.$excel({filename:this.labelNum,sheet:[{sheetName:this.labelNum,keys:["sheet1","sheet2"],table:[{sheet1:"传统商务光纤 新开,请按调单进行线路调通",sheet2:""},{sheet1:"调度依据",sheet2:this.form.num},{sheet1:"新装地址",sheet2:this.form.siteNew},{sheet1:"光路信息",sheet2:""},{sheet1:"光路名称",sheet2:this.form.cableName},{sheet1:"光路路由",sheet2:this.form.cablePath},{sheet1:"光路路由",sheet2:this.form.cableCode},{sheet1:"相关设备及数据信息",sheet2:""},{sheet1:"数据端口",sheet2:this.form2.dataPort},{sheet1:"ONU端口",sheet2:this.onuPort},{sheet1:"ONUID:"+this.form2.onuId,sheet2:"VLAN:"+this.form2.vlanNum},{sheet1:"速率"+this.form.netSpeed,sheet2:"OLT端口"+this.form2.oltPort},{sheet1:"其他信息",sheet2:""},{sheet1:"调测分局",sheet2:this.form.regions},{sheet1:"用户联系人",sheet2:this.form.contactPerson},{sheet1:"客户经理",sheet2:this.form.manager},{sheet1:"调单联系人",sheet2:this.dispatchName}],merges:["1-1:2-1","1-4:2-4","1-8:2-8","1-13:2-13"],colWidth:[50,150],globalStyle:{font:{name:"黑体"},alignment:{wrapText:!0}},cellStyle:[{cell:"1-1",fill:{fgColor:{rgb:"ffff33"}},font:{sz:14,bold:!0}},{cell:"1-4",fill:{fgColor:{rgb:"ffff33"}},font:{sz:14,bold:!0}},{cell:"1-8",fill:{fgColor:{rgb:"ffff33"}},font:{sz:14,bold:!0}},{cell:"1-13",fill:{fgColor:{rgb:"ffff33"}},font:{sz:14,bold:!0}}]}]})}}},v=b,g=(0,n.Z)(v,p,d,!1,null,"21f18f9b",null),N=g.exports,x=function(){var e=this,t=e._self._c;return t("div",{staticClass:"app"},[t("el-container",{staticClass:"container"},[t("el-container",[t("el-aside",{staticClass:"aside"},[t("el-row",[t("el-menu",{staticClass:"el-menu-vertical-demo",attrs:{"default-active":"2"},on:{select:e.moveTo}},[t("el-submenu",{attrs:{index:"1"}},[t("template",{slot:"title"},[t("i",{staticClass:"el-icon-menu"}),t("span",[e._v("传统商纤")])]),t("el-menu-item-group",[t("el-menu-item",{attrs:{index:"1-1"}},[e._v("单条新开")])],1)],2),t("el-submenu",{attrs:{index:"2"}},[t("template",{slot:"title"},[t("i",{staticClass:"el-icon-menu"}),t("span",[e._v("H中继扩容")])]),t("el-menu-item-group",[t("el-menu-item",{attrs:{index:"2-1"}},[e._v("单条扩容申请")]),t("el-menu-item",{attrs:{index:"2-2"}},[e._v("批量扩容申请")])],1)],2),t("el-submenu",{attrs:{index:"3"}},[t("template",{slot:"title"},[t("i",{staticClass:"el-icon-menu"}),t("span",[e._v("MSTP数字电路")])]),t("el-menu-item-group",[t("el-menu-item",{attrs:{index:"3-1"}},[e._v("单条新开")])],1),t("el-menu-item-group",[t("el-menu-item",{attrs:{index:"3-2"}},[e._v("批量拆机")])],1)],2)],1)],1)],1),t("el-main",{staticClass:"main"},[t("router-view")],1)],1)],1)],1)},w=[],k=(l(7658),{methods:{moveTo(e){"1-1"==e?this.$router.push("/home/fiberNew").catch((e=>{console.log(e)})):"2-1"==e?this.$router.push("/home/Hadd").catch((e=>console.log(e))):"3-1"==e?this.$router.push("/home/MSTPnew").catch((e=>console.log(e))):"3-2"==e?this.$router.push("/home/BatchMstpRemove").catch((e=>console.log(e))):"2-2"==e&&this.$router.push("/home/BatchHadd").catch((e=>console.log(e)))}}}),$=k,y=(0,n.Z)($,x,w,!1,null,"5cbcccb8",null),P=y.exports,Z=function(){var e=this,t=e._self._c;return t("div",{attrs:{id:"login-container"}},[t("div",{attrs:{id:"bigBox"}},[t("h1",[e._v("调单生成器")]),t("div",{staticClass:"inputBox"},[t("div",{staticClass:"inputText"},[t("i",{staticClass:"fas fa-user"}),t("input",{directives:[{name:"model",rawName:"v-model",value:e.username,expression:"username"}],attrs:{type:"text",placeholder:"账户"},domProps:{value:e.username},on:{input:function(t){t.target.composing||(e.username=t.target.value)}}})]),t("div",{staticClass:"inputText"},[t("i",{staticClass:"fas fa-lock"}),t("input",{directives:[{name:"model",rawName:"v-model",value:e.password,expression:"password"}],attrs:{type:"password",placeholder:"密码"},domProps:{value:e.password},on:{input:function(t){t.target.composing||(e.password=t.target.value)}}})]),t("input",{staticClass:"inputButton",attrs:{type:"button",value:"登录"},on:{click:e.moveToHome}})])])])},_=[],C={data(){return{username:"",password:"",dispatchNum:null}},methods:{moveToHome(){this.$axios.post("http://localhost:8888/users",{username:this.username,password:this.password}).then((e=>{e.data&&(console.log(e.data[0]),this.dispatchNum=e.data[0][3],this.$storeNew.set("username",this.username),this.$storeNew.set("password",this.password),this.$storeNew.set("dispatchNum",this.dispatchNum),this.$router.push("/home").catch((e=>console.log(e))))})).catch((e=>{this.$message({showClose:!0,message:"账户或密码错误!!!!",type:"error",center:!0,offset:150}),console.log(e)}))}}},S=C,D=(0,n.Z)(S,Z,_,!1,null,null,null),A=D.exports,T=function(){var e=this,t=e._self._c;return t("div",{staticClass:"left"},[t("el-form",{ref:"form",attrs:{model:e.form,"label-width":"auto"}},[t("el-form-item",{attrs:{label:"接入号"}},[t("el-input",{model:{value:e.form.num,callback:function(t){e.$set(e.form,"num",t)},expression:"form.num"}})],1),t("el-form-item",{attrs:{label:"对应分局"}},[t("el-input",{model:{value:e.form.region,callback:function(t){e.$set(e.form,"region",t)},expression:"form.region"}})],1),t("el-form-item",{attrs:{label:"扩容点位名称"}},[t("el-input",{model:{value:e.form.Hname,callback:function(t){e.$set(e.form,"Hname",t)},expression:"form.Hname"}})],1),t("el-form-item",{attrs:{label:"OLT网管标识及端口"}},[t("el-input",{model:{value:e.form.olt,callback:function(t){e.$set(e.form,"olt",t)},expression:"form.olt"}})],1),t("el-form-item",{attrs:{label:"分光器网管标识"}},[t("el-input",{model:{value:e.form.splitter,callback:function(t){e.$set(e.form,"splitter",t)},expression:"form.splitter"}})],1),t("el-form-item",{attrs:{label:"分光比"}},[t("el-input",{model:{value:e.form.splitterRate,callback:function(t){e.$set(e.form,"splitterRate",t)},expression:"form.splitterRate"}})],1),t("el-form-item",{attrs:{label:"光路路由"}},[t("el-input",{model:{value:e.form.lightPath,callback:function(t){e.$set(e.form,"lightPath",t)},expression:"form.lightPath"}})],1),t("el-form-item",{attrs:{label:"监理公司联系人"}},[t("el-input",{model:{value:e.form.supervision,callback:function(t){e.$set(e.form,"supervision",t)},expression:"form.supervision"}})],1),t("el-form-item",{attrs:{label:"光缆施工联系人"}},[t("el-input",{model:{value:e.form.construction,callback:function(t){e.$set(e.form,"construction",t)},expression:"form.construction"}})],1),t("el-form-item",{attrs:{label:"调单号"}},[t("el-input",{model:{value:e.labelNum,callback:function(t){e.labelNum=t},expression:"labelNum"}})],1),t("el-form-item",{attrs:{label:"调单联系人"}},[t("el-select",{attrs:{placeholder:"请选择"},model:{value:e.dispatchName,callback:function(t){e.dispatchName=t},expression:"dispatchName"}},e._l(e.options,(function(e){return t("el-option",{key:e.value,attrs:{label:e.label,value:e.label}})})),1)],1),t("el-form-item",[t("el-button",{attrs:{type:"primary"},on:{click:e.generateNum}},[e._v("生成调单号")]),t("el-button",{on:{click:e.reset}},[e._v("重置")])],1),t("el-form-item",[t("el-button",{attrs:{type:"success"},on:{click:e.downFile}},[e._v("导出")])],1)],1)],1)},M=[],R={created(){this.$axios.post("http://localhost:8888/users",{username:this.$storeNew.get("username"),password:this.$storeNew.get("password")}).then((e=>{this.dispatchNum=e.data[0][3]})).catch((e=>console.log(e)))},data(){return{dispatchNum:"",form:{num:"",region:"",Hname:"",olt:"",splitter:"",splitterRate:"",lightPath:"",supervision:"",construction:"",name:""},options:[{value:1,label:"岳靖川19980798836"},{value:2,label:"聂嘉聃198XXXXX"},{value:3,label:"杨蜜19980401202"}],dispatchName:""}},computed:{labelNum(){const e=new Date;return"ZYBD"+e.getFullYear()+"-"+(e.getMonth()+1)+"-"+this.dispatchNum}},methods:{generateNum(){this.dispatchNum++,this.$axios.post("http://localhost:8888/update",{dispatchNum:this.dispatchNum,username:this.$storeNew.get("username")}).then((e=>console.log(e.data))).catch((e=>console.log(e)))},reset(){for(let e in this.form)this.form[e]=""},downFile(){this.$excel({filename:this.labelNum,sheet:[{sheetName:this.labelNum,keys:["sheet1","sheet2"],table:[{sheet1:"调度依据",sheet2:this.form.num},{sheet1:this.form.region+"------"+this.form.Hname+"("+this.form.splitterRate+")",sheet2:""},{sheet1:"光路名称",sheet2:"GEPON工程(FTTH)("+this.form.num+")"+this.form.region+"/"+this.form.Hname+"001(1芯)"},{sheet1:"光路路由",sheet2:this.form.lightPath},{sheet1:this.form.region+"("+this.form.olt+")------"+this.form.splitter+" 互联",sheet2:""},{sheet1:"联调分局",sheet2:this.form.region.substring(0,2)},{sheet1:"监理公司联系人",sheet2:this.form.supervision},{sheet1:"光缆施工联系人",sheet2:this.form.construction},{sheet1:"调单联系人",sheet2:this.dispatchName}],merges:["1-2:2-2","1-5:2-5"],colWidth:[30,100],globalStyle:{font:{name:"黑体"},alignment:{wrapText:!0}},cellStyle:[{cell:"1-2",fill:{fgColor:{rgb:"ffff33"}},font:{size:14}},{cell:"1-5",fill:{fgColor:{rgb:"ffff33"}},font:{size:14}}]}]})}}},H=R,I=(0,n.Z)(H,T,M,!1,null,null,null),O=I.exports,W=function(){var e=this,t=e._self._c;return t("div",[t("div",{attrs:{id:"fomr1-container"}},[t("el-form",{attrs:{inline:!0,model:e.form1}},[e.others?t("div",{staticClass:"others"},[t("el-form-item",{attrs:{label:"客户名称"}},[t("el-select",{attrs:{placeholder:"请选择",filterable:""},on:{change:e.selectWay},model:{value:e.name,callback:function(t){e.name=t},expression:"name"}},e._l(e.centerInfo,(function(e){return t("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1)],1):t("div",{staticClass:"others"},[t("el-form-item",{attrs:{label:"客户名称"}},[t("el-input",{attrs:{placeholder:"客户名称",clearable:""},model:{value:e.name,callback:function(t){e.name=t},expression:"name"}})],1)],1),t("el-form-item",{attrs:{label:"中心点(A端)地址"}},[t("el-input",{attrs:{placeholder:"A端地址",clearable:""},model:{value:e.form1.Asite,callback:function(t){e.$set(e.form1,"Asite",t)},expression:"form1.Asite"}})],1),t("el-form-item",{attrs:{label:"A端对应分局"}},[t("el-input",{attrs:{placeholder:"A端局向",clearable:""},model:{value:e.form1.Apart,callback:function(t){e.$set(e.form1,"Apart",t)},expression:"form1.Apart"}})],1),t("el-form-item",{attrs:{label:"A端机房"}},[t("el-input",{attrs:{placeholder:"A端机房",clearable:""},model:{value:e.form1.Aroom,callback:function(t){e.$set(e.form1,"Aroom",t)},expression:"form1.Aroom"}})],1)],1)],1),t("div",{attrs:{id:"fomr2-container"}},[t("el-form",{attrs:{inline:!0,model:e.form2}},[t("el-form-item",{attrs:{label:"分支点(Z端)地址"}},[t("el-input",{attrs:{placeholder:"Z端地址",clearable:""},model:{value:e.form2.Zsite,callback:function(t){e.$set(e.form2,"Zsite",t)},expression:"form2.Zsite"}})],1),t("el-form-item",{attrs:{label:"Z端对应分局"}},[t("el-input",{attrs:{placeholder:"Z端局向",clearable:""},model:{value:e.form2.Zpart,callback:function(t){e.$set(e.form2,"Zpart",t)},expression:"form2.Zpart"}})],1),t("el-form-item",{attrs:{label:"Z端机房"}},[t("el-input",{attrs:{placeholder:"Z端机房",clearable:""},model:{value:e.form2.Zroom,callback:function(t){e.$set(e.form2,"Zroom",t)},expression:"form2.Zroom"}})],1)],1)],1),t("div",{attrs:{id:"fomr3-container"}},[t("el-form",{staticClass:"demo-form-inline",attrs:{inline:!0,model:e.form3}},[t("el-form-item",{attrs:{label:"带宽速率"}},[t("el-input",{attrs:{placeholder:"速率",clearable:""},model:{value:e.form3.netSpeed,callback:function(t){e.$set(e.form3,"netSpeed",t)},expression:"form3.netSpeed"}})],1),t("el-form-item",{attrs:{label:"用户联系人"}},[t("el-input",{attrs:{placeholder:"用户联系人",clearable:""},model:{value:e.form3.user,callback:function(t){e.$set(e.form3,"user",t)},expression:"form3.user"}})],1),t("el-form-item",{attrs:{label:"客户经理"}},[t("el-input",{attrs:{placeholder:"客户经理",clearable:""},model:{value:e.form3.manager,callback:function(t){e.$set(e.form3,"manager",t)},expression:"form3.manager"}})],1)],1)],1),t("div",{attrs:{id:"fomr4-container"}},[t("el-form",{staticClass:"demo-form-inline",attrs:{inline:!0,model:e.form4}},[t("el-form-item",{attrs:{label:"光路接入号"}},[t("el-input",{attrs:{placeholder:"光路接入号",clearable:""},model:{value:e.form4.lightPathNum,callback:function(t){e.$set(e.form4,"lightPathNum",t)},expression:"form4.lightPathNum"}})],1),t("el-form-item",{attrs:{label:"光路名称"}},[t("el-input",{attrs:{placeholder:"光路名称",clearable:""},model:{value:e.form4.lightPathName,callback:function(t){e.$set(e.form4,"lightPathName",t)},expression:"form4.lightPathName"}})],1),t("el-form-item",{attrs:{label:"光路路由"}},[t("el-input",{attrs:{placeholder:"光路路由",clearable:""},model:{value:e.form4.lightPathWay,callback:function(t){e.$set(e.form4,"lightPathWay",t)},expression:"form4.lightPathWay"}})],1)],1)],1),t("div",{attrs:{id:"form5-container"}},[t("el-form",{staticClass:"demo-form-inline",attrs:{inline:!0,model:e.form5}},[t("el-form-item",{attrs:{label:"电路接入号"}},[t("el-input",{attrs:{placeholder:"电路接入号",clearable:""},model:{value:e.form5.circuitNum,callback:function(t){e.$set(e.form5,"circuitNum",t)},expression:"form5.circuitNum"}})],1),t("el-form-item",{attrs:{label:"电路名称"}},[t("el-input",{attrs:{placeholder:"电路名称",clearable:""},model:{value:e.form5.circuitName,callback:function(t){e.$set(e.form5,"circuitName",t)},expression:"form5.circuitName"}})],1),t("el-form-item",{attrs:{label:"电路路由"}},[t("el-input",{attrs:{placeholder:"电路路由",clearable:""},model:{value:e.form5.circuitWay,callback:function(t){e.$set(e.form5,"circuitWay",t)},expression:"form5.circuitWay"}})],1),t("el-form-item",{attrs:{label:"分支点新建设备类型"}},[t("el-select",{attrs:{placeholder:"请选择"},model:{value:e.machineType,callback:function(t){e.machineType=t},expression:"machineType"}},e._l(e.form5.WaySelect,(function(e){return t("el-option",{key:e.value,attrs:{label:e.label,value:e.label}})})),1)],1),t("el-form-item",{attrs:{label:"A端是否汇聚"}},[t("el-switch",{attrs:{"active-color":"#13ce66","inactive-color":"#ff4949"},model:{value:e.form5.jugement,callback:function(t){e.$set(e.form5,"jugement",t)},expression:"form5.jugement"}})],1)],1)],1),e.form5.jugement?t("div",{attrs:{id:"form6-container"}},[t("el-form",{staticClass:"demo-form-inline",attrs:{inline:!0,model:e.form6}},[t("el-form-item",{attrs:{label:"中心点网管标识"}},[t("el-input",{attrs:{placeholder:"中心点网管标识",clearable:""},model:{value:e.form6.identification,callback:function(t){e.$set(e.form6,"identification",t)},expression:"form6.identification"}})],1),t("el-form-item",{attrs:{label:"设备端口"}},[t("el-input",{attrs:{placeholder:"设备端口",clearable:""},model:{value:e.form6.port,callback:function(t){e.$set(e.form6,"port",t)},expression:"form6.port"}})],1),t("el-form-item",{attrs:{label:"业务VLAN"}},[t("el-input",{attrs:{placeholder:"业务VLAN",clearable:""},model:{value:e.form6.vlan,callback:function(t){e.$set(e.form6,"vlan",t)},expression:"form6.vlan"}})],1)],1)],1):e._e(),t("el-form",{staticClass:"demo-form-inline",attrs:{inline:!0}},[t("el-form-item",{attrs:{label:"调单编号"}},[t("el-input",{attrs:{placeholder:"调单编号",clearable:""},model:{value:e.labelNum,callback:function(t){e.labelNum=t},expression:"labelNum"}})],1),t("el-button",{attrs:{type:"primary"},on:{click:e.generateNum}},[e._v("生成调单号")]),t("el-button",{attrs:{type:"success",round:""},on:{click:e.downBtn}},[e._v("导出")])],1)],1)},V=[],z={created(){this.$axios.post("http://localhost:8888/centerInfoSelect").then((e=>{console.log(e.data),this.centerInfo=e.data.map((e=>({value:e[1],label:e[1],site:e[2],regionPart:e[3],manager:e[4]})));const t={value:this.centerInfo.length+1,label:"其他"};this.centerInfo=[...this.centerInfo,t]})).catch((e=>console.log(e))),this.form6.dispatchNum=this.$storeNew.get("dispatchNum")},data(){return{name:"",centerInfo:[],others:!0,dispatchMan:"",phone:"",form1:{Asite:"",Apart:"",Aroom:""},form2:{Zsite:"",Zpart:"",Zroom:""},form3:{netSpeed:"",user:"",manager:""},form4:{lightPathNum:"",lightPathName:"",lightPathWay:""},form5:{circuitNum:"",circuitName:"",circuitWay:"",WaySelect:[{value:1,label:"新建光收发器"},{value:2,label:"新建MSAP多以太"}],jugement:!0},form6:{identification:"",port:"",vlan:"",dispatchNum:""},machineType:""}},computed:{labelNum(){const e=new Date;return"ZYBD"+e.getFullYear()+"-"+(e.getMonth()+1)+"-"+this.form6.dispatchNum}},methods:{selectWay(e){if(e!==this.centerInfo.length){const t=this.centerInfo.filter((t=>e==t.value));this.form1.Asite=t[0].site,this.form1.Apart=t[0].regionPart,this.form3.manager=t[0].manager}else this.name="",this.form1.Asite="",this.form1.Apart="",this.form3.manager="",this.others=!this.others},generateNum(){this.$axios.post("http://localhost:8888/update",{dispatchNum:this.form6.dispatchNum,username:this.$storeNew.get("username")}).then((e=>{this.form6.dispatchNum=e.data.dispatchNum,this.$storeNew.set("dispatchNum",this.form6.dispatchNum)})).catch((e=>console.log(e)))},downBtn(){0==this.form5.jugement&&(this.form6.identification="非汇聚",this.form6.port="无",this.form6.vlan="无"),this.$excel({filename:this.labelNum,sheet:[{sheetName:this.labelNum,keys:["col1","col2"],table:[{col1:"电路（线路）调度、局数据修改通知单（机密）",col2:""},{col1:"客户名称",col2:this.name},{col1:"用户联系人",col2:this.form3.user},{col1:"客户经理",col2:this.form3.manager},{col1:"带宽速率",col2:this.form3.netSpeed},{col1:"中心点(A端)地址",col2:this.form1.Asite},{col1:"分支点(Z端)地址",col2:this.form2.Zsite},{col1:"对应局向",col2:"A端:"+this.form1.Apart+",Z端:"+this.form2.Zpart},{col1:"光路信息",col2:""},{col1:"光路接入号",col2:this.form4.lightPathNum},{col1:"光路名称",col2:this.form4.lightPathName},{col1:"光路路由",col2:this.form4.lightPathWay},{col1:"电路信息",col2:""},{col1:"业务接入号",col2:this.form5.circuitNum},{col1:"电路名称",col2:this.form5.circuitName},{col1:"电路路由",col2:this.form5.circuitWay},{col1:"新建设备类型",col2:this.machineType},{col1:"汇聚口信息",col2:this.form6.identification+"  "+this.form6.port+"  VLAN:"+this.form6.vlan},{col1:"调单联系人",col2:this.dispatchMan+this.phone}],merges:["1-1:2-1","1-9:2-9","1-13:2-13"],colWidth:[30,100],globalStyle:{font:{name:"黑体"},alignment:{wrapText:!0}},cellStyle:[{cell:"1-1",fill:{fgColor:{rgb:"ffff33"}},font:{sz:14}},{cell:"1-9",fill:{fgColor:{rgb:"ffff33"}},font:{sz:14}},{cell:"1-13",fill:{fgColor:{rgb:"ffff33"}},font:{sz:14}}]}]})}}},j=z,B=(0,n.Z)(j,W,V,!1,null,null,null),F=B.exports,L=function(){var e=this,t=e._self._c;return t("div",[t("el-form",{attrs:{inline:!0}},[e.others?t("div",[t("el-form-item",{staticClass:"others",attrs:{label:"客户名称"}},[t("el-select",{attrs:{placeholder:"请选择",filterable:""},on:{change:e.selectWay},model:{value:e.name,callback:function(t){e.name=t},expression:"name"}},e._l(e.centerInfo,(function(e){return t("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1)],1):t("div",{staticClass:"others"},[t("el-form-item",{attrs:{label:"客户名称"}},[t("el-input",{attrs:{placeholder:"客户名称",clearable:""},model:{value:e.name,callback:function(t){e.name=t},expression:"name"}})],1)],1),t("el-form-item",{attrs:{label:"中心点(A端)地址"}},[t("el-input",{attrs:{placeholder:"A端地址",clearable:""},model:{value:e.Asite,callback:function(t){e.Asite=t},expression:"Asite"}})],1),t("el-form-item",{attrs:{label:"客户经理"}},[t("el-input",{attrs:{placeholder:"客户经理",clearable:""},model:{value:e.manager,callback:function(t){e.manager=t},expression:"manager"}})],1),t("el-form-item",{attrs:{label:"调单编号"}},[t("el-input",{attrs:{placeholder:"调单编号",clearable:""},model:{value:e.labelNum,callback:function(t){e.labelNum=t},expression:"labelNum"}})],1),t("el-button",{attrs:{type:"primary"},on:{click:e.generateNum}},[e._v("生成调单号")])],1),t("el-table",{staticStyle:{width:"100%"},attrs:{data:e.tableData}},[t("el-table-column",{attrs:{prop:"number",label:"接入号",width:"150"}}),t("el-table-column",{attrs:{prop:"speed",label:"带宽速率",width:"100"}}),t("el-table-column",{attrs:{prop:"eName",label:"电路名称",width:"180"}}),t("el-table-column",{attrs:{prop:"eVlan",label:"电路别名",width:"100"}}),t("el-table-column",{attrs:{prop:"Zpart",label:"分支点对应运营局",width:"150"}}),t("el-table-column",{attrs:{prop:"ifRemove",label:"是否拆除分支点光缆设备",width:"180"}}),t("el-table-column",{attrs:{prop:"lightNum",label:"光缆编号",width:"180"}}),t("el-table-column",{attrs:{prop:"Zsite",label:"分支点地址"}})],1),t("el-form",{attrs:{inline:!0}},[t("el-form-item",{attrs:{label:"接入号"}},[t("el-input",{attrs:{clearable:""},model:{value:e.number,callback:function(t){e.number=t},expression:"number"}})],1),t("el-form-item",{attrs:{label:"带宽速率"}},[t("el-input",{attrs:{clearable:""},model:{value:e.speed,callback:function(t){e.speed=t},expression:"speed"}})],1),t("el-form-item",{attrs:{label:"电路名称"}},[t("el-input",{attrs:{clearable:""},model:{value:e.eName,callback:function(t){e.eName=t},expression:"eName"}})],1),t("el-form-item",{attrs:{label:"电路别名"}},[t("el-input",{attrs:{clearable:""},model:{value:e.eVlan,callback:function(t){e.eVlan=t},expression:"eVlan"}})],1),t("el-form-item",{attrs:{label:"分支点对应运营局"}},[t("el-input",{attrs:{clearable:""},model:{value:e.Zpart,callback:function(t){e.Zpart=t},expression:"Zpart"}})],1),t("el-form-item",{attrs:{label:"是否拆除"}},[t("el-select",{attrs:{placeholder:"请选择"},model:{value:e.ifRemoveValue,callback:function(t){e.ifRemoveValue=t},expression:"ifRemoveValue"}},e._l(e.ifRemove,(function(e){return t("el-option",{key:e.value,attrs:{label:e.label,value:e.label}})})),1)],1),t("el-form-item",{attrs:{label:"拆机联系人"}},[t("el-input",{attrs:{clearable:""},model:{value:e.contactMan,callback:function(t){e.contactMan=t},expression:"contactMan"}})],1),t("el-form-item",{attrs:{label:"拆除光缆编号"}},[t("el-input",{attrs:{clearable:""},model:{value:e.lightNum,callback:function(t){e.lightNum=t},expression:"lightNum"}})],1),t("el-form-item",{attrs:{label:"分支点地址"}},[t("el-input",{attrs:{clearable:""},model:{value:e.Zsite,callback:function(t){e.Zsite=t},expression:"Zsite"}})],1),t("el-button",{attrs:{type:"primary"},on:{click:e.addList}},[e._v("添加")]),t("el-button",{attrs:{type:"success",round:""},on:{click:e.downBtn}},[e._v("导出")])],1)],1)},X=[],Y={created(){this.$axios.post("http://localhost:8888/centerInfoSelect").then((e=>{this.centerInfo=e.data.map((e=>({value:e.id,label:e.username,site:e.site,regionPart:e.regionPart,manager:e.manager})));const t={value:this.centerInfo.length+1,label:"其他"};this.centerInfo=[...this.centerInfo,t]})).catch((e=>console.log(e))),this.$axios.post("http://localhost:8888/users",{username:this.$storeNew.get("username"),password:this.$storeNew.get("password")}).then((e=>{this.dispatchNum=e.data[0][3],this.dispatchMan=e.data[0][4],this.phone=e.data[0][5]})).catch((e=>console.log(e)))},data(){return{others:!0,name:"",centerInfo:[],dispatchNum:"",dispatchMan:"",phone:"",manager:"",Asite:"",number:"",speed:"",eName:"",eVlan:"",Zpart:"",ifRemove:[{value:1,label:"是"},{value:2,label:"否"}],ifRemoveValue:"是",lightNum:"",Zsite:"",contactMan:"",tableData:[]}},computed:{labelNum(){const e=new Date;return"ZYBD"+e.getFullYear()+"-"+(e.getMonth()+1)+"-"+this.dispatchNum}},methods:{selectWay(e){if(e!==this.centerInfo.length){const t=this.centerInfo.filter((t=>e==t.value));this.Asite=t[0].site,this.manager=t[0].manager}else this.name="",this.Asite="",this.manager="",this.others=!this.others},generateNum(){this.dispatchNum++,this.$axios.post("http://localhost:8888/update",{dispatchNum:this.dispatchNum,username:this.$storeNew.get("username")}).then((e=>console.log(e.data))).catch((e=>console.log(e)))},addList(){this.tableData.push({number:this.number,speed:this.speed,eName:this.eName,eVlan:this.eVlan,Zpart:this.Zpart,ifRemove:this.ifRemoveValue,lightNum:this.lightNum,Zsite:this.Zsite,contactMan:this.contactMan}),this.number="",this.speed="",this.eName="",this.eVlan="",this.Zpart="",this.ifRemoveValue="",this.lightNum="",this.Zsite="",this.contactMan=""},downBtn(){this.$excel({filename:this.labelNum,sheet:[{sheetName:this.labelNum,keys:["col1","col2"],table:[{col1:"电路（线路）调度、局数据修改通知单（机密）",col2:""},{col1:"业务类型",col2:"拆机"},{col1:"中心点地址",col2:this.Asite},{col1:"分支点地址",col2:"详见附表"},{col1:"拆机联系人",col2:"详见附表"},{col1:"客户经理",col2:this.manager},{col1:"调单联系人",col2:this.dispatchMan+this.phone}],colWidth:[40,40],merges:["1-1:2-1"],globalStyle:{alignment:{wrapText:!0},font:{sz:14}},cellStyle:[{cell:"1-1",fill:{fgColor:{rgb:"ffff33"}},font:{sz:16}}]},{sheetName:"附表",title:"业务信息",tHeader:["接入号","速率","电路名称","电路别名","对应分局","是否拆除分支点设备","拆除光缆编号","分支点地址","拆机联系人"],keys:["number","speed","eName","eVlan","Zpart","ifRemove","lightNum","Zsite","contactMan"],table:this.tableData,colWidth:[15,10,40,10,10,20,15,30,20],globalStyle:{font:{sz:9}},cellStyle:[{cell:"1-1",fill:{fgColor:{rgb:"ffff33"}},font:{sz:14,bold:!0}}]}]})}}},E=Y,U=(0,n.Z)(E,L,X,!1,null,null,null),G=U.exports,q=function(){var e=this,t=e._self._c;return t("div",[t("el-form",{attrs:{inline:!0}},[t("el-form-item",{attrs:{label:"接入号"}},[t("el-input",{model:{value:e.form.num,callback:function(t){e.$set(e.form,"num",t)},expression:"form.num"}})],1),t("el-form-item",{attrs:{label:"对应分局"}},[t("el-input",{model:{value:e.form.region,callback:function(t){e.$set(e.form,"region",t)},expression:"form.region"}})],1),t("el-form-item",{attrs:{label:"扩容点位名称"}},[t("el-input",{model:{value:e.form.Hname,callback:function(t){e.$set(e.form,"Hname",t)},expression:"form.Hname"}})],1),t("el-form-item",{attrs:{label:"OLT网管标识及端口"}},[t("el-input",{model:{value:e.form.olt,callback:function(t){e.$set(e.form,"olt",t)},expression:"form.olt"}})],1),t("el-form-item",{attrs:{label:"分光器网管标识"}},[t("el-input",{model:{value:e.form.splitter,callback:function(t){e.$set(e.form,"splitter",t)},expression:"form.splitter"}})],1),t("el-form-item",{attrs:{label:"分光比"}},[t("el-input",{model:{value:e.form.splitterRate,callback:function(t){e.$set(e.form,"splitterRate",t)},expression:"form.splitterRate"}})],1),t("el-form-item",{attrs:{label:"光路路由"}},[t("el-input",{model:{value:e.form.lightPath,callback:function(t){e.$set(e.form,"lightPath",t)},expression:"form.lightPath"}})],1),t("el-form-item",{attrs:{label:"监理公司联系人"}},[t("el-input",{model:{value:e.form.supervision,callback:function(t){e.$set(e.form,"supervision",t)},expression:"form.supervision"}})],1),t("el-form-item",{attrs:{label:"光缆施工联系人"}},[t("el-input",{model:{value:e.form.construction,callback:function(t){e.$set(e.form,"construction",t)},expression:"form.construction"}})],1),t("el-form-item",{attrs:{label:"调单号"}},[t("el-input",{model:{value:e.labelNum,callback:function(t){e.labelNum=t},expression:"labelNum"}})],1),t("el-form-item",[t("el-button",{attrs:{type:"primary"},on:{click:e.generateNum}},[e._v("生成调单号")]),t("el-button",{on:{click:e.addData}},[e._v("添加")])],1),t("el-form-item",[t("el-button",{attrs:{type:"success"},on:{click:e.downFile}},[e._v("导出")])],1)],1),t("el-table",{staticStyle:{width:"100%"},attrs:{data:e.tableData}},[t("el-table-column",{attrs:{prop:"num",label:"接入号",width:"180"}}),t("el-table-column",{attrs:{prop:"region",label:"对应分局",width:"80"}}),t("el-table-column",{attrs:{prop:"Hname",label:"扩容点位名称",width:"200"}}),t("el-table-column",{attrs:{prop:"olt",label:"OLT网管标识及端口",width:"180"}}),t("el-table-column",{attrs:{prop:"splitter",label:"分光器网管标识",width:"180"}}),t("el-table-column",{attrs:{prop:"splitterRate",label:"分光比",width:"150"}}),t("el-table-column",{attrs:{prop:"lightPath",label:"光路路由",width:"250"}}),t("el-table-column",{attrs:{prop:"supervision",label:"监理公司联系人",width:"160"}}),t("el-table-column",{attrs:{prop:"construction",label:"光缆施工联系人",width:"160"}})],1)],1)},J=[],K={created(){this.$axios.post("http://localhost:8888/users",{username:this.$storeNew.get("username"),password:this.$storeNew.get("password")}).then((e=>{this.dispatchNum=e.data[0][3],this.dispatchMan=e.data[0][4],this.phone=e.data[0][5]})).catch((e=>console.log(e)))},data(){return{dispatchNum:"",form:{num:"",region:"",Hname:"",olt:"",splitter:"",splitterRate:"",lightPath:"",supervision:"",construction:""},dispatchMan:"",phone:"",tableData:[],newTable:[],mergesData:[],cellStyleData:[]}},computed:{labelNum(){const e=new Date;return"ZYBD"+e.getFullYear()+"-"+(e.getMonth()+1)+"-"+this.dispatchNum}},methods:{generateNum(){this.dispatchNum++,this.$axios.post("http://localhost:8888/update",{dispatchNum:this.dispatchNum,username:this.$storeNew.get("username")}).catch((e=>console.log(e)))},addData(){this.tableData.push({num:this.form.num,region:this.form.region,Hname:this.form.Hname,olt:this.form.olt,splitter:this.form.splitter,splitterRate:this.form.splitterRate,lightPath:this.form.lightPath,supervision:this.form.supervision,construction:this.form.construction});for(let e in this.form)this.form[e]=""},downFile(){const e=this.tableData.length;for(let t=0;t<=e-1;t++)this.newTable.push({sheet1:"调度依据",sheet2:this.tableData[t].num},{sheet1:this.tableData[t].region+"------"+this.tableData[t].Hname+"("+this.tableData[t].splitterRate+")",sheet2:""},{sheet1:"光路名称",sheet2:"GEPON工程(FTTH)("+this.tableData[t].num+")"+this.tableData[t].region+"/"+this.tableData[t].Hname+"001(1芯)"},{sheet1:"光路路由",sheet2:this.tableData[t].lightPath},{sheet1:this.tableData[t].region+"("+this.tableData[t].olt+")------"+this.tableData[t].splitter+" 互联",sheet2:""},{sheet1:"联调分局",sheet2:this.tableData[t].region.substring(0,2)},{sheet1:"监理公司联系人",sheet2:this.tableData[t].supervision},{sheet1:"光缆施工联系人",sheet2:this.tableData[t].construction}),this.mergesData.push(`1-${2+8*t}:2-${2+8*t}`,`1-${5+8*t}:2-${5+8*t}`),this.cellStyleData.push({cell:"1-"+(1+8*t),fill:{fgColor:{rgb:"ffff33"}},font:{size:16}},{cell:"2-"+(1+8*t),fill:{fgColor:{rgb:"ffff33"}},font:{size:16}});this.newTable.push({sheet1:"调单联系人",sheet2:this.dispatchMan+this.phone}),this.$excel({filename:this.labelNum,sheet:[{sheetName:this.labelNum,keys:["sheet1","sheet2"],table:this.newTable,merges:this.mergesData,colWidth:[30,100],globalStyle:{font:{name:"黑体"},alignment:{wrapText:!0}},cellStyle:this.cellStyleData}]})}}},Q=K,ee=(0,n.Z)(Q,q,J,!1,null,null,null),te=ee.exports;a["default"].use(h.ZP);const le=new h.ZP({routes:[{path:"/",redirect:"/login"},{path:"/login",component:A},{path:"/home",component:P,children:[{path:"fiberNew",component:N},{path:"Hadd",component:O},{path:"MSTPnew",component:F},{path:"BatchMstpRemove",component:G},{path:"BatchHadd",component:te}]}]});var ae=le,oe=l(8366),se=l(4161),re=l(734),ie=l.n(re),ne=l(3822);a["default"].use(ne.ZP);const me=new ne.ZP.Store({state:{dispatchNum:0},mutations:{newValue(e,t){e.dispatchNum=t}}});var ce=me;a["default"].use(f()),a["default"].prototype.$excel=oe.excelExport,a["default"].prototype.$axios=se.Z,a["default"].prototype.$storeNew=ie(),a["default"].config.productionTip=!1,new a["default"]({router:ae,store:ce,render:e=>e(c)}).$mount("#app")}},t={};function l(a){var o=t[a];if(void 0!==o)return o.exports;var s=t[a]={id:a,loaded:!1,exports:{}};return e[a].call(s.exports,s,s.exports,l),s.loaded=!0,s.exports}l.m=e,function(){l.amdO={}}(),function(){var e=[];l.O=function(t,a,o,s){if(!a){var r=1/0;for(c=0;c<e.length;c++){a=e[c][0],o=e[c][1],s=e[c][2];for(var i=!0,n=0;n<a.length;n++)(!1&s||r>=s)&&Object.keys(l.O).every((function(e){return l.O[e](a[n])}))?a.splice(n--,1):(i=!1,s<r&&(r=s));if(i){e.splice(c--,1);var m=o();void 0!==m&&(t=m)}}return t}s=s||0;for(var c=e.length;c>0&&e[c-1][2]>s;c--)e[c]=e[c-1];e[c]=[a,o,s]}}(),function(){l.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return l.d(t,{a:t}),t}}(),function(){l.d=function(e,t){for(var a in t)l.o(t,a)&&!l.o(e,a)&&Object.defineProperty(e,a,{enumerable:!0,get:t[a]})}}(),function(){l.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}()}(),function(){l.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)}}(),function(){l.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}}(),function(){l.nmd=function(e){return e.paths=[],e.children||(e.children=[]),e}}(),function(){var e={143:0};l.O.j=function(t){return 0===e[t]};var t=function(t,a){var o,s,r=a[0],i=a[1],n=a[2],m=0;if(r.some((function(t){return 0!==e[t]}))){for(o in i)l.o(i,o)&&(l.m[o]=i[o]);if(n)var c=n(l)}for(t&&t(a);m<r.length;m++)s=r[m],l.o(e,s)&&e[s]&&e[s][0](),e[s]=0;return l.O(c)},a=self["webpackChunkdispatch_project"]=self["webpackChunkdispatch_project"]||[];a.forEach(t.bind(null,0)),a.push=t.bind(null,a.push.bind(a))}();var a=l.O(void 0,[998],(function(){return l(1009)}));a=l.O(a)})();
//# sourceMappingURL=app.b424a1ae.js.map